---
kind: pipeline
type: docker
name: push-latest
steps:
- name: build-and-push
  image: plugins/docker
  settings:
    repo: ${DRONE_REPO_NAMESPACE}/${DRONE_REPO_NAME/docker-ember/ember}
    username:
      from_secret: docker_username
    password:
      from_secret: docker_password
trigger:
  branch:
  - master
  event:
    exclude:
    - pull_request
---
kind: pipeline
type: docker
name: push-release
steps:
- name: build-and-push-tag
  image: plugins/docker
  settings:
    repo: ${DRONE_REPO_NAMESPACE}/${DRONE_REPO_NAME/docker-ember/ember}
    tags: ${DRONE_TAG##v} # strips v from the tag
    username:
      from_secret: docker_username
    password:
      from_secret: docker_password
trigger:
  event:
  - tag
---
kind: pipeline
type: docker
name: dry-run
steps:
- name: dry-run
  image: plugins/docker
  settings:
    repo: ${DRONE_REPO_NAMESPACE}/${DRONE_REPO_NAME/docker-ember/ember}
    dry_run: true
trigger:
  event:
  - pull_request
---
kind: secret
name: docker_username
data: bjU6NUPceGcOWzo4GQbLZOcluwISTMqJnt0rTymzhG2xDZXFRVoq
---
kind: secret
name: docker_password
data: wSPbW073dVZtIVILr65JHz/NLWgLqCDksy+nj1yqSsKHTA2KDETRBtPNZ6/Fmh6AoDVIUVnnNva9hHHNzeCtDg==
---
kind: secret
name: docker_username
data: 80d+NMFhblK0mKgi4f6mypyshSOYbpsmfXoAY4vgbz2M6CzS8UkF
---
kind: secret
name: docker_password
data: UPYjVo8SslVHBGEL9fp7lrR8BCAuT03ATOKS2R8v1gd8hCju1A9NOLq217KyN+d+r7LINBJI/yFBn8OfLDfQhA==
---
kind: secret
name: docker_username
data: H3EIWtAD6vGMYZpCuJNg5Pa0kc7AETa+wInVXtfTRi1tnUjpsywu
---
kind: secret
name: docker_password
data: TGclgkuJbuqTpeK7j9WIEUcfsTXK8k25djV1ypuAItb0j/G2ZAjcb+jUtyqcGCwmNPJaVmeGsZ5x8CcXuL4vZw==
---
kind: signature
hmac: 3b2e124a4330cd7a8aad2f057030e375e5dbbbfa989a8a5b698f5a996592a5d2

...
