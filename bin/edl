#!/bin/bash
# This is the command to use when you would normally run "npm link"

function jsonval {
    temp=`echo $json | sed 's/\\\\\//\//g' | sed 's/[{}]//g' | awk -v k="text" '{n=split($0,a,","); for (i=1; i<=n; i++) print a[i]}' | sed 's/\"\:\"/\|/g' | sed 's/[\,]/ /g' | sed 's/\"//g' | grep -w $prop | cut -d":" -f2| sed -e 's/^ *//g' -e 's/ *$//g' `
    echo ${temp##*|}
}

if [ ! -f package.json ]; then
	 echo "Error: "
	 echo "  package.json not found, please run in the root directory of your addon"
	 exit -1
fi
prop=name
json=`cat package.json`
ln -s `pwd` /home/`whoami`/.local/lib/node_modules/`jsonval`
if [ $? == 0 ];then 
  echo "created symlink for '`jsonval`' in node_modules"
  echo "you can now add this addon to your project using 'edi npm link `jsonval`'"
fi
